"""
PROFESSIONAL PASSWORD GENERATOR
A comprehensive password generation tool with multiple features
Similar to Udemy Python projects
"""

import random
import string
import time
import os

# ==================== CONSTANTS ====================
UPPERCASE_LETTERS = string.ascii_uppercase
LOWERCASE_LETTERS = string.ascii_lowercase
DIGITS = string.digits
SYMBOLS = "!@#$%^&*()_+-=[]{}|;:,.<>?"

# ==================== UTILITY FUNCTIONS ====================

def clear_screen():
    """Clear the terminal screen"""
    os.system('cls' if os.name == 'nt' else 'clear')


def print_header():
    """Display application header"""
    print("\n" + "=" * 60)
    print(" " * 15 + "PASSWORD GENERATOR PRO")
    print("=" * 60)


def print_separator():
    """Print a visual separator"""
    print("-" * 60)


# ==================== PASSWORD GENERATION FUNCTIONS ====================

def create_character_pool(include_upper, include_lower, include_digits, include_symbols):
    """
    Create a pool of characters based on user preferences
    
    Args:
        include_upper: Boolean for uppercase letters
        include_lower: Boolean for lowercase letters
        include_digits: Boolean for digits
        include_symbols: Boolean for special symbols
    
    Returns:
        String containing all allowed characters
    """
    pool = ""
    
    if include_upper:
        pool += UPPERCASE_LETTERS
    if include_lower:
        pool += LOWERCASE_LETTERS
    if include_digits:
        pool += DIGITS
    if include_symbols:
        pool += SYMBOLS
    
    return pool


def generate_simple_password(length):
    """
    Generate a simple random password
    
    Args:
        length: Desired password length
    
    Returns:
        Generated password string
    """
    characters = UPPERCASE_LETTERS + LOWERCASE_LETTERS + DIGITS + SYMBOLS
    password = ""
    
    for i in range(length):
        password += random.choice(characters)
    
    return password


def generate_secure_password(length, include_upper=True, include_lower=True, 
                            include_digits=True, include_symbols=True):
    """
    Generate a secure password ensuring at least one of each selected type
    
    Args:
        length: Password length
        include_upper: Include uppercase letters
        include_lower: Include lowercase letters
        include_digits: Include numbers
        include_symbols: Include special characters
    
    Returns:
        Secure password string
    """
    if length < 4:
        return "Error: Password must be at least 4 characters long!"
    
    password_chars = []
    char_pool = create_character_pool(include_upper, include_lower, 
                                      include_digits, include_symbols)
    
    if not char_pool:
        return "Error: Must select at least one character type!"
    
    # Ensure at least one of each selected type
    if include_upper:
        password_chars.append(random.choice(UPPERCASE_LETTERS))
    if include_lower:
        password_chars.append(random.choice(LOWERCASE_LETTERS))
    if include_digits:
        password_chars.append(random.choice(DIGITS))
    if include_symbols:
        password_chars.append(random.choice(SYMBOLS))
    
    # Fill remaining length with random characters from pool
    remaining_length = length - len(password_chars)
    for i in range(remaining_length):
        password_chars.append(random.choice(char_pool))
    
    # Shuffle to avoid predictable patterns
    random.shuffle(password_chars)
    
    # Convert list to string
    password = ""
    for char in password_chars:
        password += char
    
    return password


def generate_memorable_password(num_words=4):
    """
    Generate a memorable password using random words and numbers
    
    Args:
        num_words: Number of words to include
    
    Returns:
        Memorable password string
    """
    word_list = ["Alpha", "Bravo", "Charlie", "Delta", "Echo", "Foxtrot",
                 "Golf", "Hotel", "India", "Juliet", "Kilo", "Lima",
                 "Mike", "November", "Oscar", "Papa", "Quebec", "Romeo",
                 "Sierra", "Tango", "Uniform", "Victor", "Whiskey", "Xray",
                 "Yankee", "Zulu", "Tiger", "Lion", "Eagle", "Shark",
                 "Falcon", "Dragon", "Phoenix", "Wolf", "Bear", "Cobra"]
    
    password = ""
    
    for i in range(num_words):
        password += random.choice(word_list)
        if i < num_words - 1:
            password += str(random.randint(0, 9))
    
    # Add special character at the end
    password += random.choice(SYMBOLS)
    
    return password


def generate_pin_code(length=4):
    """
    Generate a numeric PIN code
    
    Args:
        length: PIN length
    
    Returns:
        PIN code string
    """
    pin = ""
    
    for i in range(length):
        pin += str(random.randint(0, 9))
    
    return pin


# ==================== PASSWORD ANALYSIS FUNCTIONS ====================

def calculate_password_strength(password):
    """
    Calculate password strength score
    
    Args:
        password: Password to analyze
    
    Returns:
        Tuple of (score, strength_label)
    """
    score = 0
    
    # Length check
    length = len(password)
    if length >= 8:
        score += 1
    if length >= 12:
        score += 1
    if length >= 16:
        score += 1
    
    # Character variety checks
    has_upper = False
    has_lower = False
    has_digit = False
    has_symbol = False
    
    for char in password:
        if char.isupper():
            has_upper = True
        elif char.islower():
            has_lower = True
        elif char.isdigit():
            has_digit = True
        elif char in SYMBOLS:
            has_symbol = True
    
    if has_upper:
        score += 1
    if has_lower:
        score += 1
    if has_digit:
        score += 1
    if has_symbol:
        score += 1
    
    # Determine strength label
    if score <= 3:
        strength = "WEAK"
    elif score <= 5:
        strength = "MEDIUM"
    elif score <= 7:
        strength = "STRONG"
    else:
        strength = "VERY STRONG"
    
    return score, strength


def display_password_analysis(password):
    """
    Display detailed password analysis
    
    Args:
        password: Password to analyze
    """
    print("\n" + "=" * 60)
    print("PASSWORD ANALYSIS")
    print("=" * 60)
    print(f"Password: {password}")
    print(f"Length: {len(password)} characters")
    
    # Count character types
    uppercase_count = 0
    lowercase_count = 0
    digit_count = 0
    symbol_count = 0
    
    for char in password:
        if char.isupper():
            uppercase_count += 1
        elif char.islower():
            lowercase_count += 1
        elif char.isdigit():
            digit_count += 1
        elif char in SYMBOLS:
            symbol_count += 1
    
    print(f"Uppercase letters: {uppercase_count}")
    print(f"Lowercase letters: {lowercase_count}")
    print(f"Digits: {digit_count}")
    print(f"Symbols: {symbol_count}")
    
    score, strength = calculate_password_strength(password)
    print(f"\nStrength Score: {score}/8")
    print(f"Strength Level: {strength}")
    print("=" * 60)


# ==================== BATCH GENERATION FUNCTIONS ====================

def generate_password_batch(count, length, password_type="secure"):
    """
    Generate multiple passwords at once
    
    Args:
        count: Number of passwords to generate
        length: Length of each password
        password_type: Type of password (secure/simple/memorable)
    
    Returns:
        List of passwords
    """
    passwords = []
    
    print("\nGenerating passwords...")
    
    for i in range(count):
        if password_type == "secure":
            pwd = generate_secure_password(length)
        elif password_type == "simple":
            pwd = generate_simple_password(length)
        elif password_type == "memorable":
            pwd = generate_memorable_password(4)
        else:
            pwd = generate_simple_password(length)
        
        passwords.append(pwd)
        
        # Show progress
        print(f"Progress: {i+1}/{count}", end="\r")
        time.sleep(0.1)  # Simulate processing
    
    print("\nGeneration complete!")
    return passwords


def save_passwords_to_file(passwords, filename="passwords.txt"):
    """
    Save generated passwords to a file
    
    Args:
        passwords: List of passwords
        filename: Output filename
    """
    try:
        with open(filename, 'w') as file:
            file.write("GENERATED PASSWORDS\n")
            file.write("=" * 50 + "\n\n")
            
            for i in range(len(passwords)):
                file.write(f"{i+1}. {passwords[i]}\n")
        
        print(f"\nâœ“ Passwords saved to {filename}")
        
    except Exception as e:
        print(f"\nâœ— Error saving file: {e}")


# ==================== USER INTERFACE FUNCTIONS ====================

def get_valid_integer(prompt, min_value=1, max_value=100):
    """
    Get valid integer input from user
    
    Args:
        prompt: Input prompt message
        min_value: Minimum allowed value
        max_value: Maximum allowed value
    
    Returns:
        Valid integer
    """
    while True:
        try:
            value = int(input(prompt))
            if min_value <= value <= max_value:
                return value
            else:
                print(f"Please enter a number between {min_value} and {max_value}")
        except ValueError:
            print("Invalid input! Please enter a number.")


def get_yes_no(prompt):
    """
    Get yes/no input from user
    
    Args:
        prompt: Input prompt message
    
    Returns:
        Boolean (True for yes, False for no)
    """
    while True:
        response = input(prompt).strip().lower()
        if response in ['y', 'yes']:
            return True
        elif response in ['n', 'no']:
            return False
        else:
            print("Please enter 'y' or 'n'")


def display_menu():
    """Display main menu"""
    print("\n" + "=" * 60)
    print("MAIN MENU")
    print("=" * 60)
    print("1. Generate Simple Password")
    print("2. Generate Secure Password (Customizable)")
    print("3. Generate Memorable Password")
    print("4. Generate PIN Code")
    print("5. Generate Multiple Passwords (Batch)")
    print("6. Check Password Strength")
    print("7. Password Tips & Best Practices")
    print("8. Exit")
    print("=" * 60)


def show_password_tips():
    """Display password security tips"""
    print("\n" + "=" * 60)
    print("PASSWORD SECURITY TIPS")
    print("=" * 60)
    
    tips = [
        "Use at least 12 characters for strong passwords",
        "Include uppercase and lowercase letters",
        "Add numbers and special symbols",
        "Avoid common words and personal information",
        "Don't reuse passwords across multiple accounts",
        "Use a password manager for storage",
        "Change passwords regularly (every 3-6 months)",
        "Enable two-factor authentication when possible"
    ]
    
    for i in range(len(tips)):
        print(f"{i+1}. {tips[i]}")
    
    print("=" * 60)


# ==================== MAIN PROGRAM ====================

def main():
    """Main program execution"""
    
    while True:
        print_header()
        display_menu()
        
        choice = input("\nEnter your choice (1-8): ").strip()
        
        if choice == "1":
            # Simple Password
            length = get_valid_integer("Enter password length (8-50): ", 8, 50)
            password = generate_simple_password(length)
            print(f"\nGenerated Password: {password}")
            display_password_analysis(password)
            
        elif choice == "2":
            # Secure Password
            print("\n" + "=" * 60)
            print("SECURE PASSWORD GENERATOR")
            print("=" * 60)
            length = get_valid_integer("Enter password length (8-50): ", 8, 50)
            include_upper = get_yes_no("Include uppercase letters? (y/n): ")
            include_lower = get_yes_no("Include lowercase letters? (y/n): ")
            include_digits = get_yes_no("Include digits? (y/n): ")
            include_symbols = get_yes_no("Include symbols? (y/n): ")
            
            password = generate_secure_password(length, include_upper, 
                                               include_lower, include_digits, 
                                               include_symbols)
            print(f"\nGenerated Password: {password}")
            display_password_analysis(password)
            
        elif choice == "3":
            # Memorable Password
            num_words = get_valid_integer("Number of words (3-6): ", 3, 6)
            password = generate_memorable_password(num_words)
            print(f"\nGenerated Password: {password}")
            display_password_analysis(password)
            
        elif choice == "4":
            # PIN Code
            length = get_valid_integer("Enter PIN length (4-8): ", 4, 8)
            pin = generate_pin_code(length)
            print(f"\nGenerated PIN: {pin}")
            
        elif choice == "5":
            # Batch Generation
            print("\n" + "=" * 60)
            print("BATCH PASSWORD GENERATION")
            print("=" * 60)
            count = get_valid_integer("How many passwords? (1-50): ", 1, 50)
            length = get_valid_integer("Password length (8-50): ", 8, 50)
            
            print("\nPassword Type:")
            print("1. Simple")
            print("2. Secure")
            print("3. Memorable")
            type_choice = input("Choose type (1-3): ").strip()
            
            pwd_type = "secure"
            if type_choice == "1":
                pwd_type = "simple"
            elif type_choice == "3":
                pwd_type = "memorable"
            
            passwords = generate_password_batch(count, length, pwd_type)
            
            print("\n" + "=" * 60)
            print("GENERATED PASSWORDS")
            print("=" * 60)
            
            for i in range(len(passwords)):
                score, strength = calculate_password_strength(passwords[i])
                print(f"{i+1}. {passwords[i]} [{strength}]")
            
            save_option = get_yes_no("\nSave to file? (y/n): ")
            if save_option:
                save_passwords_to_file(passwords)
            
        elif choice == "6":
            # Password Strength Check
            password = input("\nEnter password to check: ")
            display_password_analysis(password)
            
        elif choice == "7":
            # Tips
            show_password_tips()
            
        elif choice == "8":
            # Exit
            print("\n" + "=" * 60)
            print("Thank you for using Password Generator Pro!")
            print("Stay secure! ðŸ”’")
            print("=" * 60 + "\n")
            break
            
        else:
            print("\nâœ— Invalid choice! Please select 1-8.")
        
        input("\nPress Enter to continue...")


# ==================== PROGRAM ENTRY POINT ====================

if __name__ == "__main__":
    main()
